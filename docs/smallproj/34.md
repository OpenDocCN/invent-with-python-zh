# #33 黑客小游戏

> 原文：<http://inventwithpython.com/bigbookpython/project33.html>

![](img/9d995d63aaead72cad01120081eb8f75.png)

在这个游戏中，玩家必须通过猜测一个七个字母的单词作为秘密密码来入侵电脑。电脑的记忆库显示可能的单词，并提示玩家每次猜测的接近程度。例如，如果密码是 MONITOR，但玩家猜了 CONTAIN，他们会得到提示，七个字母中有两个是正确的，因为 MONITOR 和 CONTAIN 的第二个和第三个字母都是字母 `O` 和 `N` 。这个游戏类似于项目 1，“百吉饼”，以及*余波*系列视频游戏中的黑客迷你游戏。

## 行动中的计划

当您运行 `hacking.py` 时，输出将如下所示:

```py
Hacking Minigame, by Al Sweigart email@protected
Find the password in the computer's memory:
0x1150  $],>@|~~RESOLVE^    0x1250  {>+)<!?CHICKEN,%
0x1160  }@%_-:;/$^(|<|!(    0x1260  .][})?#@#ADDRESS
0x1170  _;)][#?<&~$~+&}}    0x1270  ,#=)>{-;/DESPITE
0x1180  %[!]{email@protected?~,    0x1280  }/.}!-DISPLAY%%/
0x1190  _[^%[@}^<_+{email@protected$~    0x1290  =>>,:*%email@protected+{%#.
0x11a0  )?~/)+PENALTY?-=    0x12a0  >[,?*#email@protected$/
`--snip--`
Enter password: (4 tries remaining)
> resolve
Access Denied (2/7 correct)
Enter password: (3 tries remaining)
> improve
A C C E S S   G R A N T E D
```

## 它是如何工作的

这个游戏有一个黑客主题，但不涉及任何实际的电脑黑客行为。如果我们只是在屏幕上列出可能的单词，游戏就会完全一样。然而，模仿计算机记忆库的装饰性添加传达了一种令人兴奋的计算机黑客的感觉。对细节和用户体验的关注将一个平淡、无聊的游戏变成了一个令人兴奋的游戏。

```py
"""Hacking Minigame, by Al Sweigart email@protected #  1
The hacking mini-game from "Fallout 3". Find out which seven-letter #  2
word is the password by using clues each guess gives you. #  3
This code is available at https://nostarch.com/big-book-small-python-programming #  4
Tags: large, artistic, game, puzzle""" #  5
 #  6
# NOTE: This program requires the sevenletterwords.txt file. You can #  7
# download it from https://inventwithpython.com/sevenletterwords.txt #  8
 #  9
import random, sys #  10
 #  11
# Set up the constants: #  12
# The garbage filler characters for the "computer memory" display. #  13
GARBAGE_CHARS = 'email@protected#$%^&*()_+-={}[]|;:,.<>?/' #  14
 #  15
# Load the WORDS list from a text file that has 7-letter words. #  16
with open('sevenletterwords.txt') as wordListFile: #  17
   WORDS = wordListFile.readlines() #  18
for i in range(len(WORDS)): #  19
   # Convert each word to uppercase and remove the trailing newline: #  20
   WORDS[i] = WORDS[i].strip().upper() #  21
 #  22
 #  23
def main(): #  24
   """Run a single game of Hacking.""" #  25
   print('''Hacking Minigame, by Al Sweigart email@protected #  26
Find the password in the computer's memory. You are given clues after #  27
each guess. For example, if the secret password is MONITOR but the #  28
player guessed CONTAIN, they are given the hint that 2 out of 7 letters #  29
were correct, because both MONITOR and CONTAIN have the letter O and N #  30
as their 2nd and 3rd letter. You get four guesses.\n''') #  31
   input('Press Enter to begin...') #  32
 #  33
   gameWords = getWords() #  34
   # The "computer memory" is just cosmetic, but it looks cool: #  35
   computerMemory = getComputerMemoryString(gameWords) #  36
   secretPassword = random.choice(gameWords) #  37
 #  38
   print(computerMemory) #  39
   # Start at 4 tries remaining, going down: #  40
   for triesRemaining in range(4, 0, -1): #  41
       playerMove = askForPlayerGuess(gameWords, triesRemaining) #  42
       if playerMove == secretPassword: #  43
           print('A C C E S S   G R A N T E D') #  44
           return #  45
       else: #  46
           numMatches = numMatchingLetters(secretPassword, playerMove) #  47
           print('Access Denied ({}/7 correct)'.format(numMatches)) #  48
   print('Out of tries. Secret password was {}.'.format(secretPassword)) #  49
 #  50
 #  51
def getWords(): #  52
   """Return a list of 12 words that could possibly be the password. #  53
 #  54
   The secret password will be the first word in the list. #  55
   To make the game fair, we try to ensure that there are words with #  56
   a range of matching numbers of letters as the secret word.""" #  57
   secretPassword = random.choice(WORDS) #  58
   words = [secretPassword] #  59
 #  60
   # Find two more words; these have zero matching letters. #  61
   # We use "< 3" because the secret password is already in words. #  62
   while len(words) < 3: #  63
       randomWord = getOneWordExcept(words) #  64
       if numMatchingLetters(secretPassword, randomWord) == 0: #  65
           words.append(randomWord) #  66
 #  67
   # Find two words that have 3 matching letters (but give up at 500 #  68
   # tries if not enough can be found). #  69
   for i in range(500): #  70
       if len(words) == 5: #  71
           break  # Found 5 words, so break out of the loop. #  72
 #  73
       randomWord = getOneWordExcept(words) #  74
       if numMatchingLetters(secretPassword, randomWord) == 3: #  75
           words.append(randomWord) #  76
 #  77
   # Find at least seven words that have at least one matching letter #  78
   # (but give up at 500 tries if not enough can be found). #  79
   for i in range(500): #  80
       if len(words) == 12: #  81
           break  # Found 7 or more words, so break out of the loop. #  82
 #  83
       randomWord = getOneWordExcept(words) #  84
       if numMatchingLetters(secretPassword, randomWord) != 0: #  85
           words.append(randomWord) #  86
 #  87
   # Add any random words needed to get 12 words total. #  88
   while len(words) < 12: #  89
       randomWord = getOneWordExcept(words) #  90
       words.append(randomWord) #  91
 #  92
   assert len(words) == 12 #  93
   return words #  94
 #  95
 #  96
def getOneWordExcept(blocklist=None): #  97
   """Returns a random word from WORDS that isn't in blocklist.""" #  98
   if blocklist == None: #  99
        blocklist = [] # 100
 # 101
    while True: # 102
        randomWord = random.choice(WORDS) # 103
        if randomWord not in blocklist: # 104
            return randomWord # 105
 # 106
 # 107
def numMatchingLetters(word1, word2): # 108
    """Returns the number of matching letters in these two words.""" # 109
    matches = 0 # 110
    for i in range(len(word1)): # 111
        if word1[i] == word2[i]: # 112
            matches += 1 # 113
    return matches # 114
 # 115
 # 116
def getComputerMemoryString(words): # 117
    """Return a string representing the "computer memory".""" # 118
 # 119
    # Pick one line per word to contain a word. There are 16 lines, but # 120
    # they are split into two halves. # 121
    linesWithWords = random.sample(range(16 * 2), len(words)) # 122
    # The starting memory address (this is also cosmetic). # 123
    memoryAddress = 16 * random.randint(0, 4000) # 124
 # 125
    # Create the "computer memory" string. # 126
    computerMemory = []  # Will contain 16 strings, one for each line. # 127
    nextWord = 0  # The index in words of the word to put into a line. # 128
    for lineNum in range(16):  # The "computer memory" has 16 lines. # 129
        # Create a half line of garbage characters: # 130
        leftHalf = '' # 131
        rightHalf = '' # 132
        for j in range(16):  # Each half line has 16 characters. # 133
            leftHalf += random.choice(GARBAGE_CHARS) # 134
            rightHalf += random.choice(GARBAGE_CHARS) # 135
 # 136
        # Fill in the password from words: # 137
        if lineNum in linesWithWords: # 138
            # Find a random place in the half line to insert the word: # 139
            insertionIndex = random.randint(0, 9) # 140
            # Insert the word: # 141
            leftHalf = (leftHalf[:insertionIndex] + words[nextWord] # 142
                + leftHalf[insertionIndex + 7:]) # 143
            nextWord += 1  # Update the word to put in the half line. # 144
        if lineNum + 16 in linesWithWords: # 145
            # Find a random place in the half line to insert the word: # 146
            insertionIndex = random.randint(0, 9) # 147
            # Insert the word: # 148
            rightHalf = (rightHalf[:insertionIndex] + words[nextWord] # 149
                + rightHalf[insertionIndex + 7:]) # 150
            nextWord += 1  # Update the word to put in the half line. # 151
 # 152
        computerMemory.append('0x' + hex(memoryAddress)[2:].zfill(4) # 153
                     + '  ' + leftHalf + '    ' # 154
                     + '0x' + hex(memoryAddress + (16*16))[2:].zfill(4) # 155
                     + '  ' + rightHalf) # 156
 # 157
        memoryAddress += 16  # Jump from, say, 0xe680 to 0xe690. # 158
 # 159
    # Each string in the computerMemory list is joined into one large # 160
    # string to return: # 161
    return '\n'.join(computerMemory) # 162
 # 163
 # 164
def askForPlayerGuess(words, tries): # 165
    """Let the player enter a password guess.""" # 166
    while True: # 167
        print('Enter password: ({} tries remaining)'.format(tries)) # 168
        guess = input('> ').upper() # 169
        if guess in words: # 170
            return guess # 171
        print('That is not one of the possible passwords listed above.') # 172
        print('Try entering "{}" or "{}".'.format(words[0], words[1])) # 173
 # 174
 # 175
# If this program was run (instead of imported), run the game: # 176
if __name__ == '__main__': # 177
    try: # 178
        main() # 179
    except KeyboardInterrupt: # 180
        sys.exit()  # When Ctrl-C is pressed, end the program.  # 181
```

在输入源代码并运行几次之后，尝试对其进行实验性的修改。你也可以自己想办法做到以下几点:

*   在互联网上找到一个单词列表，创建你自己的文件 `sevenletterwords.txt` ，也许是一个由六个或八个字母组成的文件。
*   创建一个不同的“计算机内存”的可视化

## 探索计划

试着找出下列问题的答案。尝试对代码进行一些修改，然后重新运行程序，看看这些修改有什么影响。

1.  如果把 133 行的`for j in range(16):`改成`for j in range(0):`会怎么样？
2.  如果把第 14 行的`GARBAGE_CHARS = 'email@protected#$%^&*()_+-={}[]|;:,.<>?/'`改成`GARBAGE_CHARS = '.'`会怎么样？
3.  如果把第 34 行的`gameWords = getWords()`改成`gameWords = ['MALKOVICH'] * 20`会怎么样？
4.  如果将第 94 行的`return words`改为`return`，会得到什么错误信息？
5.  如果把 103 行的`randomWord = random.choice(WORDS)`改成`secretPassword = 'PASSWORD'`会怎么样？