# #13 康威的人生游戏

> 原文：<http://inventwithpython.com/bigbookpython/project13.html>

![](img/9d995d63aaead72cad01120081eb8f75.png)

康威的生命游戏是一种细胞自动机模拟，它遵循简单的规则来创建有趣的模式。它是由数学家约翰·康威在 1970 年发明的，并由马丁·加德纳在《科学美国人》的“数学游戏”专栏推广开来。今天，它是程序员和计算机科学家的最爱，尽管它更像是一个有趣的可视化而不是真正的“游戏”二维棋盘有一个“单元格”网格，每个单元格都遵循三个简单的规则:

*   具有两个或三个邻居的活细胞在模拟的下一步中保持存活。
*   在模拟的下一步中，正好有三个邻居的死细胞变成活的。
*   在模拟的下一步中，任何其他细胞死亡或保持死亡。

下一步模拟中细胞的活或死状态完全取决于它们的当前状态。这些细胞不会“记住”任何旧的状态。关于这些简单规则产生的模式，有大量的研究。不幸的是，康威教授于 2020 年 4 月因并发症在新冠肺炎去世。更多关于康威《生命的游戏》的信息可以在[`en.wikipedia.org/wiki/Conway%27s_Game_of_Life`](https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life)找到，更多关于马丁·加德纳的信息可以在[`en.wikipedia.org/wiki/Martin_Gardner`](https://en.wikipedia.org/wiki/Martin_Gardner)找到。

## 行动中的计划

当您运行 `conwaysgameoflife.py` 时，输出将如下所示:

```py
 O                  O                 OO      O  O
O     O    O  O                 O                      O OOOO          O OO
OO    O   O                     O          O            O              O O
OO        O    O                          OO                        OO
OO        OO                             O O    O                    OO
                                         OO    O O                    O  OO
            OOO                          OO    OO                       O
                                                O    OOO
                                    O             O                     O O
                   OO             OO OO             OO  O
                   OOO               OO          OOOO    O  O
             O     OO                O O       O  OO  OO O   O    OO
             O  O                 O    O          O   OO O    O  OOO
             O                     OOOO  OO       OO   O    OOOOO O
OO            O                      O   OOO     O OOO        OOOO       O
```

## 它是如何工作的

单元的状态存储在字典中的`cells`和`nextCells`变量中。两个字典都有键的`(x, y)`元组(其中`x`和`y`是整数)，活细胞的`'O'`，死细胞的`' '`。第 40 到 44 行被设置为将这些字典的表示打印到屏幕上。`cells`变量的字典表示单元的当前状态，而`nextCells`存储模拟下一步中单元的字典。

```py
"""Conway's Game of Life, by Al Sweigart email@protected #  1
The classic cellular automata simulation. Press Ctrl-C to stop. #  2
More info at: https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life #  3
This code is available at https://nostarch.com/big-book-small-python-programming #  4
Tags: short, artistic, simulation""" #  5
 #  6
import copy, random, sys, time #  7
 #  8
# Set up the constants: #  9
WIDTH = 79   # The width of the cell grid. # 10
HEIGHT = 20  # The height of the cell grid. # 11
 # 12
# (!) Try changing ALIVE to '#' or another character: # 13
ALIVE = 'O'  # The character representing a living cell. # 14
# (!) Try changing DEAD to '.' or another character: # 15
DEAD = ' '   # The character representing a dead cell. # 16
 # 17
# (!) Try changing ALIVE to '|' and DEAD to '-'. # 18
 # 19
# The cells and nextCells are dictionaries for the state of the game. # 20
# Their keys are (x, y) tuples and their values are one of the ALIVE # 21
# or DEAD values. # 22
nextCells = {} # 23
# Put random dead and alive cells into nextCells: # 24
for x in range(WIDTH):  # Loop over every possible column. # 25
    for y in range(HEIGHT):  # Loop over every possible row. # 26
        # 50/50 chance for starting cells being alive or dead. # 27
        if random.randint(0, 1) == 0: # 28
            nextCells[(x, y)] = ALIVE  # Add a living cell. # 29
        else: # 30
            nextCells[(x, y)] = DEAD  # Add a dead cell. # 31
 # 32
while True:  # Main program loop. # 33
    # Each iteration of this loop is a step of the simulation. # 34
 # 35
    print('\n' * 50)  # Separate each step with newlines. # 36
    cells = copy.deepcopy(nextCells) # 37
 # 38
    # Print cells on the screen: # 39
    for y in range(HEIGHT): # 40
        for x in range(WIDTH): # 41
            print(cells[(x, y)], end='')  # Print the # or space. # 42
        print()  # Print a newline at the end of the row. # 43
    print('Press Ctrl-C to quit.') # 44
 # 45
    # Calculate the next step's cells based on current step's cells: # 46
    for x in range(WIDTH): # 47
        for y in range(HEIGHT): # 48
            # Get the neighboring coordinates of (x, y), even if they # 49
            # wrap around the edge: # 50
            left  = (x - 1) % WIDTH # 51
            right = (x + 1) % WIDTH # 52
            above = (y - 1) % HEIGHT # 53
            below = (y + 1) % HEIGHT # 54
 # 55
            # Count the number of living neighbors: # 56
            numNeighbors = 0 # 57
            if cells[(left, above)] == ALIVE: # 58
                numNeighbors += 1  # Top-left neighbor is alive. # 59
            if cells[(x, above)] == ALIVE: # 60
                numNeighbors += 1  # Top neighbor is alive. # 61
            if cells[(right, above)] == ALIVE: # 62
                numNeighbors += 1  # Top-right neighbor is alive. # 63
            if cells[(left, y)] == ALIVE: # 64
                numNeighbors += 1  # Left neighbor is alive. # 65
            if cells[(right, y)] == ALIVE: # 66
                numNeighbors += 1  # Right neighbor is alive. # 67
            if cells[(left, below)] == ALIVE: # 68
                numNeighbors += 1  # Bottom-left neighbor is alive. # 69
            if cells[(x, below)] == ALIVE: # 70
                numNeighbors += 1  # Bottom neighbor is alive. # 71
            if cells[(right, below)] == ALIVE: # 72
                numNeighbors += 1  # Bottom-right neighbor is alive. # 73
 # 74
            # Set cell based on Conway's Game of Life rules: # 75
            if cells[(x, y)] == ALIVE and (numNeighbors == 2 # 76
                or numNeighbors == 3): # 77
                    # Living cells with 2 or 3 neighbors stay alive: # 78
                    nextCells[(x, y)] = ALIVE # 79
            elif cells[(x, y)] == DEAD and numNeighbors == 3: # 80
                # Dead cells with 3 neighbors become alive: # 81
                nextCells[(x, y)] = ALIVE # 82
            else: # 83
                # Everything else dies or stays dead: # 84
                nextCells[(x, y)] = DEAD # 85
 # 86
    try: # 87
        time.sleep(1)  # Add a 1 second pause to reduce flickering. # 88
    except KeyboardInterrupt: # 89
        print("Conway's Game of Life") # 90
        print('By Al Sweigart email@protected') # 91
        sys.exit()  # When Ctrl-C is pressed, end the program.  # 92
```

在输入源代码并运行几次之后，尝试对其进行实验性的修改。标有`(!)`的评论对你可以做的小改变有建议。你也可以自己想办法做到以下几点:

*   调整开始为活细胞的百分比，而不是总是使用 50%。
*   添加从文本文件中读取初始状态的功能，这样用户可以手动编辑起始单元格状态。

## 探索计划

试着找出下列问题的答案。尝试对代码进行一些修改，然后重新运行程序，看看这些修改有什么影响。

1.  把 10 行的`WIDTH = 79`改成`WIDTH = 7`会怎么样？
2.  如果删除或注释掉第 36 行的`print('\n' * 50)`会发生什么？
3.  如果把第 28 行的`random.randint(0, 1)`改成`random.randint(0, 10)`会怎么样？
4.  如果把第 85 行的`nextCells[(x, y)] = DEAD`改成`nextCells[(x, y)] = ALIVE`会怎么样？