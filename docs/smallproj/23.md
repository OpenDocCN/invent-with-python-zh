# #22 小鸭子

> 原文：<http://inventwithpython.com/bigbookpython/project22.html>

![](img/9d995d63aaead72cad01120081eb8f75.png)

这个程序创建了一个滚动的小鸭场。每只小鸭子都略有不同:它们可以面向左边或右边，有两种不同的体型，四种眼睛，两种嘴巴，三种翅膀位置。这给了我们 96 种不同的可能变异，这些变异是小鸭程序不断产生的。

## 行动中的计划

当你运行`ducklings.py`的时候，输出将如下所示:

```py
Duckling Screensaver, by Al Sweigart email@protected
Press Ctrl-C to quit...
                                             =" )
=")                                          (  v)=")
( ^)                                          ^ ^ ( v) >'')
 ^^                                                ^^  (  ^)
                              >")                       ^ ^
                              ( v)      =^^)
 ("<  ("<                >")   ^^       (  >)
(^ ) (< )                ( ^)            ^ ^
 ^^   ^^             ("<  ^^                       (``<>^^)
 (^^=               (^ )                          (<  )(  ^)
(v  ) ( "<           ^^                            ^ ^  ^ ^
`--snip--`
```

## 它是如何工作的

这个程序用一个`Duckling`类表示小鸭子。在这个类的`__init__()`方法中选择了每只鸭子的随机特征，而每只鸭子的各个身体部分由`getHeadStr()`、`getBodyStr()`和`getFeetStr()`方法返回。

```py
"""Duckling Screensaver, by Al Sweigart email@protected #  1
A screensaver of many many ducklings. #  2
 #  3
>" )   =^^)    (``=   ("=  >")    ("= #  4
(  >)  (  ^)  (v  )  (^ )  ( >)  (v ) #  5
^ ^    ^ ^    ^ ^    ^^    ^^    ^^ #  6
 #  7
This code is available at https://nostarch.com/big-book-small-python-programming #  8
Tags: large, artistic, object-oriented, scrolling""" #  9
 #  10
import random, shutil, sys, time #  11
 #  12
# Set up the constants: #  13
PAUSE = 0.2  # (!) Try changing this to 1.0 or 0.0. #  14
DENSITY = 0.10  # (!) Try changing this to anything from 0.0 to 1.0. #  15
 #  16
DUCKLING_WIDTH = 5 #  17
LEFT = 'left' #  18
RIGHT = 'right' #  19
BEADY = 'beady' #  20
WIDE = 'wide' #  21
HAPPY = 'happy' #  22
ALOOF = 'aloof' #  23
CHUBBY = 'chubby' #  24
VERY_CHUBBY = 'very chubby' #  25
OPEN = 'open' #  26
CLOSED = 'closed' #  27
OUT = 'out' #  28
DOWN = 'down' #  29
UP = 'up' #  30
HEAD = 'head' #  31
BODY = 'body' #  32
FEET = 'feet' #  33
 #  34
# Get the size of the terminal window: #  35
WIDTH = shutil.get_terminal_size()[0] #  36
# We can't print to the last column on Windows without it adding a #  37
# newline automatically, so reduce the width by one: #  38
WIDTH -= 1 #  39
 #  40
 #  41
def main(): #  42
   print('Duckling Screensaver, by Al Sweigart') #  43
   print('Press Ctrl-C to quit...') #  44
   time.sleep(2) #  45
 #  46
   ducklingLanes = [None] * (WIDTH // DUCKLING_WIDTH) #  47
 #  48
   while True:  # Main program loop. #  49
       for laneNum, ducklingObj in enumerate(ducklingLanes): #  50
           # See if we should create a duckling in this lane: #  51
           if (ducklingObj == None and random.random() <= DENSITY): #  52
                   # Place a duckling in this lane: #  53
                   ducklingObj = Duckling() #  54
                   ducklingLanes[laneNum] = ducklingObj #  55
 #  56
           if ducklingObj != None: #  57
               # Draw a duckling if there is one in this lane: #  58
               print(ducklingObj.getNextBodyPart(), end='') #  59
               # Delete the duckling if we've finished drawing it: #  60
               if ducklingObj.partToDisplayNext == None: #  61
                   ducklingLanes[laneNum] = None #  62
           else: #  63
               # Draw five spaces since there is no duckling here. #  64
               print(' ' * DUCKLING_WIDTH, end='') #  65
 #  66
       print()  # Print a newline. #  67
       sys.stdout.flush()  # Make sure text appears on the screen. #  68
       time.sleep(PAUSE) #  69
 #  70
 #  71
class Duckling: #  72
   def __init__(self): #  73
       """Create a new duckling with random body features.""" #  74
       self.direction = random.choice([LEFT, RIGHT]) #  75
       self.body = random.choice([CHUBBY, VERY_CHUBBY]) #  76
       self.mouth = random.choice([OPEN, CLOSED]) #  77
       self.wing = random.choice([OUT, UP, DOWN]) #  78
 #  79
       if self.body == CHUBBY: #  80
           # Chubby ducklings can only have beady eyes. #  81
           self.eyes = BEADY #  82
       else: #  83
           self.eyes = random.choice([BEADY, WIDE, HAPPY, ALOOF]) #  84
 #  85
       self.partToDisplayNext = HEAD #  86
 #  87
   def getHeadStr(self): #  88
       """Returns the string of the duckling's head.""" #  89
       headStr = '' #  90
       if self.direction == LEFT: #  91
           # Get the mouth: #  92
           if self.mouth == OPEN: #  93
               headStr += '>' #  94
           elif self.mouth == CLOSED: #  95
               headStr += '=' #  96
 #  97
           # Get the eyes: #  98
           if self.eyes == BEADY and self.body == CHUBBY: #  99
                headStr += '"' # 100
            elif self.eyes == BEADY and self.body == VERY_CHUBBY: # 101
                headStr += '" ' # 102
            elif self.eyes == WIDE: # 103
                headStr += "''" # 104
            elif self.eyes == HAPPY: # 105
                headStr += '^^' # 106
            elif self.eyes == ALOOF: # 107
                headStr += '``' # 108
 # 109
            headStr += ') '  # Get the back of the head. # 110
 # 111
        if self.direction == RIGHT: # 112
            headStr += ' ('  # Get the back of the head. # 113
 # 114
            # Get the eyes: # 115
            if self.eyes == BEADY and self.body == CHUBBY: # 116
                headStr += '"' # 117
            elif self.eyes == BEADY and self.body == VERY_CHUBBY: # 118
                headStr += ' "' # 119
            elif self.eyes == WIDE: # 120
                headStr += "''" # 121
            elif self.eyes == HAPPY: # 122
                headStr += '^^' # 123
            elif self.eyes == ALOOF: # 124
                headStr += '``' # 125
 # 126
            # Get the mouth: # 127
            if self.mouth == OPEN: # 128
                headStr += '<' # 129
            elif self.mouth == CLOSED: # 130
                headStr += '=' # 131
 # 132
        if self.body == CHUBBY: # 133
            # Get an extra space so chubby ducklings are the same # 134
            # width as very chubby ducklings. # 135
            headStr += ' ' # 136
 # 137
        return headStr # 138
 # 139
    def getBodyStr(self): # 140
        """Returns the string of the duckling's body.""" # 141
        bodyStr = '('  # Get the left side of the body. # 142
        if self.direction == LEFT: # 143
            # Get the interior body space: # 144
            if self.body == CHUBBY: # 145
                bodyStr += ' ' # 146
            elif self.body == VERY_CHUBBY: # 147
                bodyStr += '  ' # 148
 # 149
            # Get the wing: # 150
            if self.wing == OUT: # 151
                bodyStr += '>' # 152
            elif self.wing == UP: # 153
                bodyStr += '^' # 154
            elif self.wing == DOWN: # 155
                bodyStr += 'v' # 156
 # 157
        if self.direction == RIGHT: # 158
            # Get the wing: # 159
            if self.wing == OUT: # 160
                bodyStr += '<' # 161
            elif self.wing == UP: # 162
                bodyStr += '^' # 163
            elif self.wing == DOWN: # 164
                bodyStr += 'v' # 165
 # 166
            # Get the interior body space: # 167
            if self.body == CHUBBY: # 168
                bodyStr += ' ' # 169
            elif self.body == VERY_CHUBBY: # 170
                bodyStr += '  ' # 171
 # 172
        bodyStr += ')'  # Get the right side of the body. # 173
 # 174
        if self.body == CHUBBY: # 175
            # Get an extra space so chubby ducklings are the same # 176
            # width as very chubby ducklings. # 177
            bodyStr += ' ' # 178
 # 179
        return bodyStr # 180
 # 181
    def getFeetStr(self): # 182
        """Returns the string of the duckling's feet.""" # 183
        if self.body == CHUBBY: # 184
            return ' ^^  ' # 185
        elif self.body == VERY_CHUBBY: # 186
            return ' ^ ^ ' # 187
 # 188
    def getNextBodyPart(self): # 189
        """Calls the appropriate display method for the next body # 190
        part that needs to be displayed. Sets partToDisplayNext to # 191
        None when finished.""" # 192
        if self.partToDisplayNext == HEAD: # 193
            self.partToDisplayNext = BODY # 194
            return self.getHeadStr() # 195
        elif self.partToDisplayNext == BODY: # 196
            self.partToDisplayNext = FEET # 197
            return self.getBodyStr() # 198
        elif self.partToDisplayNext == FEET: # 199
            self.partToDisplayNext = None # 200
            return self.getFeetStr() # 201
 # 202
 # 203
 # 204
# If this program was run (instead of imported), run the game: # 205
if __name__ == '__main__': # 206
    try: # 207
        main() # 208
    except KeyboardInterrupt: # 209
        sys.exit()  # When Ctrl-C is pressed, end the program.  # 210
```

在输入源代码并运行几次之后，尝试对其进行实验性的修改。标有`(!)`的评论对你可以做的小改变有建议。

## 探索计划

试着找出下列问题的答案。尝试对代码进行一些修改，然后重新运行程序，看看这些修改有什么影响。

1.  如果将第 75 行的`random.choice([LEFT, RIGHT])` 改为`random.choice([LEFT])?`会发生什么
2.  如果把 194 行的`self.partToDisplayNext = BODY`改成`self.partToDisplayNext = None`会怎么样？
3.  如果把 197 行的`self.partToDisplayNext = FEET`改成`self.partToDisplayNext = BODY`会怎么样？
4.  如果把 195 行的`return` `self.getHeadStr()`改成`return` `self.getFeetStr()`会怎么样？