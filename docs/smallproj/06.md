# #5 弹跳 DVD 标志

> 原文：<http://inventwithpython.com/bigbookpython/project5.html>

![](img/9d995d63aaead72cad01120081eb8f75.png)

如果你到了一定的年龄，你会记得那些被称为 DVD 播放器的古老技术设备。当不播放 DVD 时，他们会显示一个从屏幕边缘反弹回来的对角线方向的 DVD 标志。这个程序通过每次碰到边缘时改变方向来模拟这个彩色的 DVD 标志。我们还将记录一个标志点击屏幕一角的次数。这创造了一个有趣的视觉动画，特别是当一个标志与一个角完美地对齐的神奇时刻。

您不能从您的集成开发环境(IDE)或编辑器运行此程序，因为它使用了`bext`模块。因此，必须从命令提示符或终端运行它才能正确显示。你可以在`pypi.org/project/bext`找到更多关于`bext`模块的信息。

## 行动中的计划

当你运行 `bouncingdvd.py` 时，输出将看起来像[图 5-1](#calibre_link-336) 。

![f05001](img/4cd22c4dff5545c12f8ccf035fb96475.png)

`bouncingdvd.py`节目的斜向移动的 DVD 标识

## 它是如何工作的

你可能还记得学校数学课上的笛卡尔坐标。在编程中，x 坐标表示对象的水平位置，y 坐标表示其垂直位置，就像数学中一样。然而，与数学中不同的是，原点(0，0)在屏幕的左上角，y 坐标随着向下移动而增加。x 坐标随着对象向右移动而增加，就像数学中一样。[图 5-2](#calibre_link-337) 显示了屏幕的坐标系统。

![f05002](img/b95f3a29cdd99e92ee2ef58123b02d0c.png)

:原点(0，0)在屏幕的左上方，x 和 y 坐标分别向右下递增。

`bext`模块的`goto()`功能工作方式相同:调用`bext.goto(0, 0)`将文本光标放在终端窗口的左上角。我们使用一个 Python 字典，用关键字`'color'`、`'direction'`、`'x'`和`'y'`来表示每个跳动的 DVD 标志。`'x'`和`'y'`的值是代表窗口中徽标位置的整数。由于这些值被传递到`bext.goto()`，增加它们将使徽标向右和向下移动，而减少它们将使徽标向左和向上移动。

```py
"""Bouncing DVD Logo, by Al Sweigart email@protected #  1
A bouncing DVD logo animation. You have to be "of a certain age" to #  2
appreciate this. Press Ctrl-C to stop. #  3
 #  4
NOTE: Do not resize the terminal window while this program is running. #  5
This code is available at https://nostarch.com/big-book-small-python-programming #  6
Tags: short, artistic, bext""" #  7
 #  8
import sys, random, time #  9
 #  10
try: #  11
   import bext #  12
except ImportError: #  13
   print('This program requires the bext module, which you') #  14
   print('can install by following the instructions at') #  15
   print('https://pypi.org/project/Bext/') #  16
   sys.exit() #  17
 #  18
# Set up the constants: #  19
WIDTH, HEIGHT = bext.size() #  20
# We can't print to the last column on Windows without it adding a #  21
# newline automatically, so reduce the width by one: #  22
WIDTH -= 1 #  23
 #  24
NUMBER_OF_LOGOS = 5  # (!) Try changing this to 1 or 100. #  25
PAUSE_AMOUNT = 0.2  # (!) Try changing this to 1.0 or 0.0. #  26
# (!) Try changing this list to fewer colors: #  27
COLORS = ['red', 'green', 'yellow', 'blue', 'magenta', 'cyan', 'white'] #  28
 #  29
UP_RIGHT   = 'ur' #  30
UP_LEFT    = 'ul' #  31
DOWN_RIGHT = 'dr' #  32
DOWN_LEFT  = 'dl' #  33
DIRECTIONS = (UP_RIGHT, UP_LEFT, DOWN_RIGHT, DOWN_LEFT) #  34
 #  35
# Key names for logo dictionaries: #  36
COLOR = 'color' #  37
X = 'x' #  38
Y = 'y' #  39
DIR = 'direction' #  40
 #  41
 #  42
def main(): #  43
   bext.clear() #  44
 #  45
   # Generate some logos. #  46
   logos = [] #  47
   for i in range(NUMBER_OF_LOGOS): #  48
       logos.append({COLOR: random.choice(COLORS), #  49
                     X: random.randint(1, WIDTH - 4), #  50
                     Y: random.randint(1, HEIGHT - 4), #  51
                     DIR: random.choice(DIRECTIONS)}) #  52
       if logos[-1][X] % 2 == 1: #  53
           # Make sure X is even so it can hit the corner. #  54
           logos[-1][X] -= 1 #  55
 #  56
   cornerBounces = 0  # Count how many times a logo hits a corner. #  57
   while True:  # Main program loop. #  58
       for logo in logos:  # Handle each logo in the logos list. #  59
           # Erase the logo's current location: #  60
           bext.goto(logo[X], logo[Y]) #  61
           print('   ', end='')  # (!) Try commenting this line out. #  62
 #  63
           originalDirection = logo[DIR] #  64
 #  65
           # See if the logo bounces off the corners: #  66
           if logo[X] == 0 and logo[Y] == 0: #  67
               logo[DIR] = DOWN_RIGHT #  68
               cornerBounces += 1 #  69
           elif logo[X] == 0 and logo[Y] == HEIGHT - 1: #  70
               logo[DIR] = UP_RIGHT #  71
               cornerBounces += 1 #  72
           elif logo[X] == WIDTH - 3 and logo[Y] == 0: #  73
               logo[DIR] = DOWN_LEFT #  74
               cornerBounces += 1 #  75
           elif logo[X] == WIDTH - 3 and logo[Y] == HEIGHT - 1: #  76
               logo[DIR] = UP_LEFT #  77
               cornerBounces += 1 #  78
 #  79
           # See if the logo bounces off the left edge: #  80
           elif logo[X] == 0 and logo[DIR] == UP_LEFT: #  81
               logo[DIR] = UP_RIGHT #  82
           elif logo[X] == 0 and logo[DIR] == DOWN_LEFT: #  83
               logo[DIR] = DOWN_RIGHT #  84
 #  85
           # See if the logo bounces off the right edge: #  86
           # (WIDTH - 3 because 'DVD' has 3 letters.) #  87
           elif logo[X] == WIDTH - 3 and logo[DIR] == UP_RIGHT: #  88
               logo[DIR] = UP_LEFT #  89
           elif logo[X] == WIDTH - 3 and logo[DIR] == DOWN_RIGHT: #  90
               logo[DIR] = DOWN_LEFT #  91
 #  92
           # See if the logo bounces off the top edge: #  93
           elif logo[Y] == 0 and logo[DIR] == UP_LEFT: #  94
               logo[DIR] = DOWN_LEFT #  95
           elif logo[Y] == 0 and logo[DIR] == UP_RIGHT: #  96
               logo[DIR] = DOWN_RIGHT #  97
 #  98
           # See if the logo bounces off the bottom edge: #  99
            elif logo[Y] == HEIGHT - 1 and logo[DIR] == DOWN_LEFT: # 100
                logo[DIR] = UP_LEFT # 101
            elif logo[Y] == HEIGHT - 1 and logo[DIR] == DOWN_RIGHT: # 102
                logo[DIR] = UP_RIGHT # 103
 # 104
            if logo[DIR] != originalDirection: # 105
                # Change color when the logo bounces: # 106
                logo[COLOR] = random.choice(COLORS) # 107
 # 108
            # Move the logo. (X moves by 2 because the terminal # 109
            # characters are twice as tall as they are wide.) # 110
            if logo[DIR] == UP_RIGHT: # 111
                logo[X] += 2 # 112
                logo[Y] -= 1 # 113
            elif logo[DIR] == UP_LEFT: # 114
                logo[X] -= 2 # 115
                logo[Y] -= 1 # 116
            elif logo[DIR] == DOWN_RIGHT: # 117
                logo[X] += 2 # 118
                logo[Y] += 1 # 119
            elif logo[DIR] == DOWN_LEFT: # 120
                logo[X] -= 2 # 121
                logo[Y] += 1 # 122
 # 123
        # Display number of corner bounces: # 124
        bext.goto(5, 0) # 125
        bext.fg('white') # 126
        print('Corner bounces:', cornerBounces, end='') # 127
 # 128
        for logo in logos: # 129
            # Draw the logos at their new location: # 130
            bext.goto(logo[X], logo[Y]) # 131
            bext.fg(logo[COLOR]) # 132
            print('DVD', end='') # 133
 # 134
        bext.goto(0, 0) # 135
 # 136
        sys.stdout.flush()  # (Required for bext-using programs.) # 137
        time.sleep(PAUSE_AMOUNT) # 138
 # 139
 # 140
# If this program was run (instead of imported), run the game: # 141
if __name__ == '__main__': # 142
    try: # 143
        main() # 144
    except KeyboardInterrupt: # 145
        print() # 146
        print('Bouncing DVD Logo, by Al Sweigart') # 147
        sys.exit()  # When Ctrl-C is pressed, end the program.  # 148
```

在输入源代码并运行几次之后，尝试对其进行实验性的修改。标有`(!)`的评论对你可以做的小改变有建议。你也可以自己想办法做到以下几点:

*   更改`NUMBER_OF_LOGOS`以增加屏幕上跳跃标志的数量。
*   更改`PAUSE_AMOUNT`以加快或减慢徽标的速度。

## 探索计划

试着找出下列问题的答案。尝试对代码进行一些修改，然后重新运行程序，看看这些修改有什么影响。

1.  如果把第 20 行的`WIDTH, HEIGHT = bext.size()`改成`WIDTH, HEIGHT = 10, 5`会怎么样？
2.  如果把第 52 行的`DIR: random.choice(DIRECTIONS)`换成`DIR: DOWN_RIGHT`会怎么样？
3.  如何让`'Corner bounces:'`文字不出现在屏幕上？
4.  如果删除或注释掉第 57 行的`cornerBounces = 0`,会得到什么错误信息？